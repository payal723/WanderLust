<% layout('/layouts/boilerplate') -%>

<div class="container-fluid px-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">Your Wishlist</h2>
        <span class="text-muted"><%= listings.length %> saved</span>
      </div>
      
      <% if (listings.length === 0) { %>
        <div class="empty-wishlist text-center py-5">
          <div class="empty-icon mb-3">
            <i class="fas fa-heart" style="font-size: 4rem; color: #ddd;"></i>
          </div>
          <h3 class="mb-3">Your wishlist is empty</h3>
          <p class="text-muted mb-4">Start exploring and save your favorite places</p>
          <a href="/listings" class="btn btn-primary">Explore listings</a>
        </div>
      <% } else { %>
        <div class="wishlist-grid">
          <% for (let listing of listings) { %>
            <div class="wishlist-card">
              <a href="/listings/<%= listing._id %>" class="listing-link">
                <div class="listing-image-container">
                  <img src="<%= listing.image.url %>" class="listing-image" alt="<%= listing.title %>">
                  <button class="heart-btn liked" onclick="toggleWishlist(event, '<%= listing._id %>')">
                    <svg width="16" height="16" viewBox="0 0 32 32">
                      <path d="M16 28c7-4.733 14-10 14-17a6.98 6.98 0 0 0-7-7c-1.8 0-3.58.68-4.95 2.05L16 8.108l-2.05-2.058A6.976 6.976 0 0 0 9 4a6.98 6.98 0 0 0-7 7c0 7 7 12.267 14 17z"></path>
                    </svg>
                  </button>
                </div>
                <div class="listing-content">
                  <div class="listing-header">
                    <h3 class="listing-title"><%= listing.title %></h3>
                    <div class="listing-rating">
                      <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                        <path d="M6 0l1.545 3.13L11 3.635 8.5 6.07l.59 3.44L6 8.13 2.91 9.51l.59-3.44L1 3.635l3.455-.505z"></path>
                      </svg>
                      <span>New</span>
                    </div>
                  </div>
                  <p class="listing-location"><%= listing.location %>, <%= listing.country %></p>
                  <div class="listing-price">
                    <strong>â‚¹<%= listing.price.toLocaleString("en-IN") %></strong> night
                  </div>
                </div>
              </a>
            </div>
          <% } %>
        </div>
      <% } %>
    </div>
  </div>
</div>

<style>
.wishlist-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 24px;
  padding: 24px 0;
}

.wishlist-card {
  position: relative;
}

.listing-link {
  text-decoration: none;
  color: inherit;
  display: block;
}

.listing-image-container {
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 12px;
}

.listing-image {
  width: 100%;
  height: 280px;
  object-fit: cover;
  transition: transform 0.2s ease;
}

.wishlist-card:hover .listing-image {
  transform: scale(1.05);
}

.heart-btn {
  position: absolute;
  top: 12px;
  right: 12px;
  background: rgba(255, 255, 255, 0.9);
  border: none;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 10;
}

.heart-btn:hover {
  background: white;
  transform: scale(1.1);
}

.heart-btn svg {
  fill: none;
  stroke: #222;
  stroke-width: 2;
}

.heart-btn.liked svg {
  fill: #fe424d;
  stroke: #fe424d;
}

.listing-content {
  padding: 0 4px;
}

.listing-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 4px;
}

.listing-title {
  font-size: 15px;
  font-weight: 600;
  color: #222;
  margin: 0;
  line-height: 1.2;
  flex: 1;
  margin-right: 8px;
}

.listing-rating {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 14px;
  color: #222;
  flex-shrink: 0;
}

.listing-rating svg {
  fill: #222;
}

.listing-location {
  color: #717171;
  font-size: 15px;
  margin: 0 0 8px 0;
  line-height: 1.2;
}

.listing-price {
  font-size: 15px;
  color: #222;
  margin: 0;
}

.listing-price strong {
  font-weight: 600;
}

.empty-wishlist {
  max-width: 400px;
  margin: 0 auto;
}

.btn-primary {
  background: #fe424d;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  font-weight: 600;
}

.btn-primary:hover {
  background: #e63b45;
}

@media (max-width: 768px) {
  .wishlist-grid {
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 16px;
  }
  
  .listing-image {
    height: 240px;
  }
}
</style>